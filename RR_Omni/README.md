# RR オムニ駆動用ファームウェア
本プログラムはRRオムニ駆動用のファームウェアです。
# 機能
## CAN インターフェイス
| CAN ID        | Tx/Rx | byte長 | Data                                                                                   | 
|---------------|-------|-------|----------------------------------------------------------------------------------------|
| 0x101         | Rx    | 16    | (float)[0:Omni1の速度(m/s):3][4:Omni1の速度(m/s):7][8:Omni1の速度(m/s):11][12:Omni1の速度(m/s):15] |
| 0x900 + 1*[x] | Tx    | 1     | [0:MCUのステート(0xff):1]                                                                   |


x∈{1...4}
## 制御
PID制御にて、指定された速度（エンコーダーにて所得）にモーターを追従させる。

100msごとにステートを発信する。


### やったこと
* system view Timebase sourceをsystickからTIM17に変更
* PIDをまとめたヘッダファイル，ソースファイルを入れた
* SIDE Aのピン割り当て
* UARTのRxCpltInterruptでシリアルモニタからtarget_velocityを変えられるようにした（テスト用）

>**Note**
> CAN通信が出来ないとプログラムが止まるので，CAN通信なしでテストするときは該当部分を無効にする

| 割り当て          | 用途                          |
|---------------|-----------------------------|
| TIM1(PA8,PA9) | エンコーダ読み取り(Encoder Mode)     | 
| TIM2          | エンコーダ読み取り，PID計算，PWM制御 (1kHz) |
| TIM4(PB6)     | PWM(10kHz)生成                |
|PB7 | モタドラの方向制御                   |
|PA10 | エンコーダX相(今回は未使用)             |